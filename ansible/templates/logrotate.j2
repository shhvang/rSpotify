# Log rotation configuration for rSpotify Bot
# Generated by Ansible for {{ environment }} environment
# Manages log files to prevent disk space issues

{{ app_dir }}/logs/*.log {
    # Rotate logs daily
    daily
    
    # Keep 14 days of logs
    rotate 14
    
    # Don't error if log file is missing
    missingok
    
    # Don't rotate if log is empty
    notifempty
    
    # Compress rotated logs
    compress
    
    # Delay compression until next rotation
    delaycompress
    
    # Use date as suffix instead of number
    dateext
    
    # Create new log file after rotation
    create 0640 {{ app_user }} {{ app_user }}
    
    # Share log files between multiple processes
    sharedscripts
    
    # Run after rotation
    postrotate
        # Reload supervisor to reopen log files
        /usr/bin/supervisorctl restart rspotify-bot > /dev/null 2>&1 || true
    endscript
}